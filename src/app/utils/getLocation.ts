const location = {
  plus_code: {
    compound_code: "5QCH+H39 Surat, Gujarat, India",
    global_code: "7JHJ5QCH+H39",
  },
  results: [
    {
      address_components: [
        {
          long_name: "5QCG+FXJ",
          short_name: "5QCG+FXJ",
          types: ["plus_code"],
        },
        {
          long_name: "Umra Gam",
          short_name: "Umra Gam",
          types: ["political", "sublocality", "sublocality_level_2"],
        },
        {
          long_name: "Athwa",
          short_name: "Athwa",
          types: ["political", "sublocality", "sublocality_level_1"],
        },
        {
          long_name: "Surat",
          short_name: "Surat",
          types: ["locality", "political"],
        },
        {
          long_name: "Surat",
          short_name: "Surat",
          types: ["administrative_area_level_3", "political"],
        },
        {
          long_name: "Gujarat",
          short_name: "GJ",
          types: ["administrative_area_level_1", "political"],
        },
        {
          long_name: "India",
          short_name: "IN",
          types: ["country", "political"],
        },
        {
          long_name: "395007",
          short_name: "395007",
          types: ["postal_code"],
        },
      ],
      formatted_address:
        "5QCG+FXJ, Umra Gam, Athwa, Surat, Rundh, Gujarat 395007, India",
      geometry: {
        location: {
          lat: 21.1712159,
          lng: 72.7773922,
        },
        location_type: "GEOMETRIC_CENTER",
        viewport: {
          northeast: {
            lat: 21.1725648802915,
            lng: 72.77874118029149,
          },
          southwest: {
            lat: 21.1698669197085,
            lng: 72.77604321970848,
          },
        },
      },
      place_id: "ChIJ0XJZwTdN4DsRRuCP1KHF9mk",
      types: ["establishment", "point_of_interest", "school"],
    },
    {
      address_components: [
        {
          long_name: "Kshetrapal Society",
          short_name: "Kshetrapal Society",
          types: ["neighborhood", "political"],
        },
        {
          long_name: "Umra Gam",
          short_name: "Umra Gam",
          types: ["political", "sublocality", "sublocality_level_2"],
        },
        {
          long_name: "Athwa",
          short_name: "Athwa",
          types: ["political", "sublocality", "sublocality_level_1"],
        },
        {
          long_name: "Surat",
          short_name: "Surat",
          types: ["locality", "political"],
        },
        {
          long_name: "Surat",
          short_name: "Surat",
          types: ["administrative_area_level_3", "political"],
        },
        {
          long_name: "Gujarat",
          short_name: "GJ",
          types: ["administrative_area_level_1", "political"],
        },
        {
          long_name: "India",
          short_name: "IN",
          types: ["country", "political"],
        },
        {
          long_name: "395007",
          short_name: "395007",
          types: ["postal_code"],
        },
      ],
      formatted_address:
        "B-11,12, Kshetrapal Society, Umra Gam, Athwa, Surat, Rundh, Gujarat 395007, India",
      geometry: {
        location: {
          lat: 21.1711317,
          lng: 72.77808809999999,
        },
        location_type: "ROOFTOP",
        viewport: {
          northeast: {
            lat: 21.1724806802915,
            lng: 72.7794370802915,
          },
          southwest: {
            lat: 21.1697827197085,
            lng: 72.7767391197085,
          },
        },
      },
      place_id: "ChIJoafQ0YpN4DsRaFYRKh1qWSA",
      plus_code: {
        compound_code: "5QCH+F6 Surat, Gujarat, India",
        global_code: "7JHJ5QCH+F6",
      },
      types: ["street_address"],
    },
    {
      address_components: [
        {
          long_name: "5QCH+H3",
          short_name: "5QCH+H3",
          types: ["plus_code"],
        },
        {
          long_name: "Surat",
          short_name: "Surat",
          types: ["locality", "political"],
        },
        {
          long_name: "Surat",
          short_name: "Surat",
          types: ["administrative_area_level_3", "political"],
        },
        {
          long_name: "Gujarat",
          short_name: "GJ",
          types: ["administrative_area_level_1", "political"],
        },
        {
          long_name: "India",
          short_name: "IN",
          types: ["country", "political"],
        },
      ],
      formatted_address: "5QCH+H3 Surat, Gujarat, India",
      geometry: {
        bounds: {
          northeast: {
            lat: 21.1715,
            lng: 72.77775,
          },
          southwest: {
            lat: 21.171375,
            lng: 72.777625,
          },
        },
        location: {
          lat: 21.1714048,
          lng: 72.777728,
        },
        location_type: "GEOMETRIC_CENTER",
        viewport: {
          northeast: {
            lat: 21.1727864802915,
            lng: 72.77903648029151,
          },
          southwest: {
            lat: 21.1700885197085,
            lng: 72.7763385197085,
          },
        },
      },
      place_id: "GhIJnmBaL-ErNUARvkupS8YxUkA",
      plus_code: {
        compound_code: "5QCH+H3 Surat, Gujarat, India",
        global_code: "7JHJ5QCH+H3",
      },
      types: ["plus_code"],
    },
    {
      address_components: [
        {
          long_name: "Ramnath Gela Road",
          short_name: "Ramnath Gela Rd",
          types: ["route"],
        },
        {
          long_name: "Umra Gam",
          short_name: "Umra Gam",
          types: ["political", "sublocality", "sublocality_level_2"],
        },
        {
          long_name: "Athwa",
          short_name: "Athwa",
          types: ["political", "sublocality", "sublocality_level_1"],
        },
        {
          long_name: "Rundh",
          short_name: "Rundh",
          types: ["locality", "political"],
        },
        {
          long_name: "Surat",
          short_name: "Surat",
          types: ["administrative_area_level_3", "political"],
        },
        {
          long_name: "Gujarat",
          short_name: "GJ",
          types: ["administrative_area_level_1", "political"],
        },
        {
          long_name: "India",
          short_name: "IN",
          types: ["country", "political"],
        },
        {
          long_name: "395007",
          short_name: "395007",
          types: ["postal_code"],
        },
      ],
      formatted_address:
        "Ramnath Gela Rd, Umra Gam, Athwa, Rundh, Surat, Gujarat 395007, India",
      geometry: {
        bounds: {
          northeast: {
            lat: 21.1727419,
            lng: 72.77804189999999,
          },
          southwest: {
            lat: 21.1720978,
            lng: 72.7773193,
          },
        },
        location: {
          lat: 21.1724962,
          lng: 72.77755069999999,
        },
        location_type: "GEOMETRIC_CENTER",
        viewport: {
          northeast: {
            lat: 21.1737688302915,
            lng: 72.7790295802915,
          },
          southwest: {
            lat: 21.1710708697085,
            lng: 72.7763316197085,
          },
        },
      },
      place_id: "ChIJ7RazNL5N4DsR69aij5SfMw4",
      types: ["route"],
    },
    {
      address_components: [
        {
          long_name: "Kshetrapal Society",
          short_name: "Kshetrapal Society",
          types: ["neighborhood", "political"],
        },
        {
          long_name: "Umra Gam",
          short_name: "Umra Gam",
          types: ["political", "sublocality", "sublocality_level_2"],
        },
        {
          long_name: "Athwa",
          short_name: "Athwa",
          types: ["political", "sublocality", "sublocality_level_1"],
        },
        {
          long_name: "Surat",
          short_name: "Surat",
          types: ["locality", "political"],
        },
        {
          long_name: "Surat",
          short_name: "Surat",
          types: ["administrative_area_level_3", "political"],
        },
        {
          long_name: "Gujarat",
          short_name: "GJ",
          types: ["administrative_area_level_1", "political"],
        },
        {
          long_name: "India",
          short_name: "IN",
          types: ["country", "political"],
        },
        {
          long_name: "395007",
          short_name: "395007",
          types: ["postal_code"],
        },
      ],
      formatted_address:
        "Kshetrapal Society, Umra Gam, Athwa, Surat, Gujarat 395007, India",
      geometry: {
        bounds: {
          northeast: {
            lat: 21.1718907,
            lng: 72.77974069999999,
          },
          southwest: {
            lat: 21.1703859,
            lng: 72.7774438,
          },
        },
        location: {
          lat: 21.1711996,
          lng: 72.7783919,
        },
        location_type: "APPROXIMATE",
        viewport: {
          northeast: {
            lat: 21.1724872802915,
            lng: 72.77994123029151,
          },
          southwest: {
            lat: 21.1697893197085,
            lng: 72.77724326970849,
          },
        },
      },
      place_id: "ChIJx94IY5VN4DsRqX7H-9WWyXs",
      types: ["neighborhood", "political"],
    },
    {
      address_components: [
        {
          long_name: "Umra Gam",
          short_name: "Umra Gam",
          types: ["political", "sublocality", "sublocality_level_2"],
        },
        {
          long_name: "Athwa",
          short_name: "Athwa",
          types: ["political", "sublocality", "sublocality_level_1"],
        },
        {
          long_name: "Surat",
          short_name: "Surat",
          types: ["locality", "political"],
        },
        {
          long_name: "Surat",
          short_name: "Surat",
          types: ["administrative_area_level_3", "political"],
        },
        {
          long_name: "Gujarat",
          short_name: "GJ",
          types: ["administrative_area_level_1", "political"],
        },
        {
          long_name: "India",
          short_name: "IN",
          types: ["country", "political"],
        },
      ],
      formatted_address: "Umra Gam, Athwa, Surat, Gujarat, India",
      geometry: {
        bounds: {
          northeast: {
            lat: 21.1813621,
            lng: 72.794761,
          },
          southwest: {
            lat: 21.1678179,
            lng: 72.76959099999999,
          },
        },
        location: {
          lat: 21.1747791,
          lng: 72.783597,
        },
        location_type: "APPROXIMATE",
        viewport: {
          northeast: {
            lat: 21.1813621,
            lng: 72.794761,
          },
          southwest: {
            lat: 21.1678179,
            lng: 72.76959099999999,
          },
        },
      },
      place_id: "ChIJbzkRTpVN4DsRVJAe2xwY7Sc",
      types: ["political", "sublocality", "sublocality_level_2"],
    },
    {
      address_components: [
        {
          long_name: "Rundh",
          short_name: "Rundh",
          types: ["locality", "political"],
        },
        {
          long_name: "Surat",
          short_name: "Surat",
          types: ["administrative_area_level_3", "political"],
        },
        {
          long_name: "Gujarat",
          short_name: "GJ",
          types: ["administrative_area_level_1", "political"],
        },
        {
          long_name: "India",
          short_name: "IN",
          types: ["country", "political"],
        },
      ],
      formatted_address: "Rundh, Gujarat, India",
      geometry: {
        bounds: {
          northeast: {
            lat: 21.1822201,
            lng: 72.7896401,
          },
          southwest: {
            lat: 21.14189,
            lng: 72.7579999,
          },
        },
        location: {
          lat: 21.1735068,
          lng: 72.7802981,
        },
        location_type: "APPROXIMATE",
        viewport: {
          northeast: {
            lat: 21.1822201,
            lng: 72.7896401,
          },
          southwest: {
            lat: 21.14189,
            lng: 72.7579999,
          },
        },
      },
      place_id: "ChIJD00AnZFN4DsRbuPZ4BJlAGk",
      types: ["locality", "political"],
    },
    {
      address_components: [
        {
          long_name: "Athwa",
          short_name: "Athwa",
          types: ["political", "sublocality", "sublocality_level_1"],
        },
        {
          long_name: "Surat",
          short_name: "Surat",
          types: ["locality", "political"],
        },
        {
          long_name: "Surat",
          short_name: "Surat",
          types: ["administrative_area_level_3", "political"],
        },
        {
          long_name: "Gujarat",
          short_name: "GJ",
          types: ["administrative_area_level_1", "political"],
        },
        {
          long_name: "India",
          short_name: "IN",
          types: ["country", "political"],
        },
      ],
      formatted_address: "Athwa, Surat, Gujarat, India",
      geometry: {
        bounds: {
          northeast: {
            lat: 21.1879311,
            lng: 72.820589,
          },
          southwest: {
            lat: 21.1540339,
            lng: 72.76959099999999,
          },
        },
        location: {
          lat: 21.1739055,
          lng: 72.7937029,
        },
        location_type: "APPROXIMATE",
        viewport: {
          northeast: {
            lat: 21.1879311,
            lng: 72.820589,
          },
          southwest: {
            lat: 21.1540339,
            lng: 72.76959099999999,
          },
        },
      },
      place_id: "ChIJGeYPpudN4DsRMduZHzPzjn4",
      types: ["political", "sublocality", "sublocality_level_1"],
    },
    {
      address_components: [
        {
          long_name: "395007",
          short_name: "395007",
          types: ["postal_code"],
        },
        {
          long_name: "Surat",
          short_name: "Surat",
          types: ["locality", "political"],
        },
        {
          long_name: "Surat",
          short_name: "Surat",
          types: ["administrative_area_level_3", "political"],
        },
        {
          long_name: "Gujarat",
          short_name: "GJ",
          types: ["administrative_area_level_1", "political"],
        },
        {
          long_name: "India",
          short_name: "IN",
          types: ["country", "political"],
        },
      ],
      formatted_address: "Surat, Gujarat 395007, India",
      geometry: {
        bounds: {
          northeast: {
            lat: 21.1833475,
            lng: 72.8210527,
          },
          southwest: {
            lat: 21.0903551,
            lng: 72.7196869,
          },
        },
        location: {
          lat: 21.1597606,
          lng: 72.7959122,
        },
        location_type: "APPROXIMATE",
        viewport: {
          northeast: {
            lat: 21.1833475,
            lng: 72.8210527,
          },
          southwest: {
            lat: 21.0903551,
            lng: 72.7196869,
          },
        },
      },
      place_id: "ChIJZ6a6gXJS4DsRVR-8o7cmE7w",
      types: ["postal_code"],
    },
    {
      address_components: [
        {
          long_name: "Surat City",
          short_name: "Surat City",
          types: ["administrative_area_level_4", "political"],
        },
        {
          long_name: "Surat",
          short_name: "Surat",
          types: ["administrative_area_level_3", "political"],
        },
        {
          long_name: "Gujarat",
          short_name: "GJ",
          types: ["administrative_area_level_1", "political"],
        },
        {
          long_name: "India",
          short_name: "IN",
          types: ["country", "political"],
        },
      ],
      formatted_address: "Surat City, Gujarat, India",
      geometry: {
        bounds: {
          northeast: {
            lat: 21.3064138,
            lng: 72.91648099999999,
          },
          southwest: {
            lat: 21.0556624,
            lng: 72.66982329999999,
          },
        },
        location: {
          lat: 21.1802956,
          lng: 72.81851069999999,
        },
        location_type: "APPROXIMATE",
        viewport: {
          northeast: {
            lat: 21.3064138,
            lng: 72.91648099999999,
          },
          southwest: {
            lat: 21.0556624,
            lng: 72.66982329999999,
          },
        },
      },
      place_id: "ChIJB3pwL9tN4DsR2tfOmSwUFzs",
      types: ["administrative_area_level_4", "political"],
    },
    {
      address_components: [
        {
          long_name: "Surat",
          short_name: "Surat",
          types: ["locality", "political"],
        },
        {
          long_name: "Surat",
          short_name: "Surat",
          types: ["administrative_area_level_3", "political"],
        },
        {
          long_name: "Gujarat",
          short_name: "GJ",
          types: ["administrative_area_level_1", "political"],
        },
        {
          long_name: "India",
          short_name: "IN",
          types: ["country", "political"],
        },
      ],
      formatted_address: "Surat, Gujarat, India",
      geometry: {
        bounds: {
          northeast: {
            lat: 21.2705834,
            lng: 72.9432106,
          },
          southwest: {
            lat: 21.0478169,
            lng: 72.7013819,
          },
        },
        location: {
          lat: 21.1702401,
          lng: 72.83106070000001,
        },
        location_type: "APPROXIMATE",
        viewport: {
          northeast: {
            lat: 21.2705834,
            lng: 72.9432106,
          },
          southwest: {
            lat: 21.0478169,
            lng: 72.7013819,
          },
        },
      },
      place_id: "ChIJYxUdQVlO4DsRQrA4CSlYRf4",
      types: ["locality", "political"],
    },
    {
      address_components: [
        {
          long_name: "Surat",
          short_name: "Surat",
          types: ["administrative_area_level_3", "political"],
        },
        {
          long_name: "Gujarat",
          short_name: "GJ",
          types: ["administrative_area_level_1", "political"],
        },
        {
          long_name: "India",
          short_name: "IN",
          types: ["country", "political"],
        },
      ],
      formatted_address: "Surat, Gujarat, India",
      geometry: {
        bounds: {
          northeast: {
            lat: 21.5692624,
            lng: 73.6991285,
          },
          southwest: {
            lat: 20.8155901,
            lng: 72.59750269999999,
          },
        },
        location: {
          lat: 21.2628965,
          lng: 72.99329689999999,
        },
        location_type: "APPROXIMATE",
        viewport: {
          northeast: {
            lat: 21.5692624,
            lng: 73.6991285,
          },
          southwest: {
            lat: 20.8155901,
            lng: 72.59750269999999,
          },
        },
      },
      place_id: "ChIJBSupQeZD4DsRrX6wckP2g20",
      types: ["administrative_area_level_3", "political"],
    },
    {
      address_components: [
        {
          long_name: "Gujarat",
          short_name: "GJ",
          types: ["administrative_area_level_1", "political"],
        },
        {
          long_name: "India",
          short_name: "IN",
          types: ["country", "political"],
        },
      ],
      formatted_address: "Gujarat, India",
      geometry: {
        bounds: {
          northeast: {
            lat: 24.7125362,
            lng: 74.4764324,
          },
          southwest: {
            lat: 20.1192287,
            lng: 68.17751179999999,
          },
        },
        location: {
          lat: 22.6708317,
          lng: 71.5723953,
        },
        location_type: "APPROXIMATE",
        viewport: {
          northeast: {
            lat: 24.7125362,
            lng: 74.4764324,
          },
          southwest: {
            lat: 20.1192287,
            lng: 68.17751179999999,
          },
        },
      },
      place_id: "ChIJlfcOXx8FWTkRLlJU7YfYG4Y",
      types: ["administrative_area_level_1", "political"],
    },
    {
      address_components: [
        {
          long_name: "India",
          short_name: "IN",
          types: ["country", "political"],
        },
      ],
      formatted_address: "India",
      geometry: {
        bounds: {
          northeast: {
            lat: 35.6733149,
            lng: 97.39535869999999,
          },
          southwest: {
            lat: 6.4626999,
            lng: 68.1097,
          },
        },
        location: {
          lat: 20.593684,
          lng: 78.96288,
        },
        location_type: "APPROXIMATE",
        viewport: {
          northeast: {
            lat: 35.6733149,
            lng: 97.39535869999999,
          },
          southwest: {
            lat: 6.4626999,
            lng: 68.1097,
          },
        },
      },
      place_id: "ChIJkbeSa_BfYzARphNChaFPjNc",
      types: ["country", "political"],
    },
  ],
  status: "OK",
};

export const getCountry = (data: LocationDataType): string | undefined => {
  for (let i = 0; i < data.results.length; i++) {
    const country = data.results[i].address_components.find(i =>
      i.types.includes("country")
    );
    if (country) {
      return country.long_name;
    }
  }

  return undefined;
};

export const getState = (data: LocationDataType): string | undefined => {
  for (let i = 0; i < data.results.length; i++) {
    const state = data.results[i].address_components.find(i =>
      i.types.includes("administrative_area_level_1")
    );
    if (state) {
      return state.long_name;
    }
  }
  return undefined;
};
export const getCity = (data: LocationDataType): string | undefined => {
  for (let i = 0; i < data.results.length; i++) {
    const city = data.results[i].address_components.find(i =>
      i.types.includes("administrative_area_level_3")
    );
    if (city) {
      return city.long_name;
    }
  }
  return undefined;
};

export const getPostalCode = (data: LocationDataType): string | undefined => {
  for (let i = 0; i < data.results.length; i++) {
    const postalCode = data.results[i].address_components.find(i =>
      i.types.includes("postal_code")
    );
    if (postalCode) {
      return postalCode.long_name;
    }
  }
  return undefined;
};

export const handleGetLocation = async (
  latitude: number,
  longitude: number
) => {
  try {
    const res = await fetch(
      `https://maps.googleapis.com/maps/api/geocode/json?latlng=${latitude},${longitude}&key=${process.env.NEXT_PUBLIC_GOOGLE_MAP_API_KEY}`
    );
    const json: LocationDataType = await res.json();
    if (json.status === "OK") {
      const obj: {
        state?: string;
        city?: string;
        postalCode?: string;
      } = {};
      if (getCountry(json) === "India") {
        const state = getState(json);
        const city = getCity(json);
        const postalCode = getPostalCode(json);

        if (state) {
          obj.state = state;
        }
        if (city) {
          obj.city = city;
        }
        if (postalCode) {
          obj.postalCode = postalCode;
        }
        return obj;
      }
    }
    return {};
  } catch (err) {
    return {};
  }
};

export type LocationDataType = {
  plus_code: Pluscode;
  results: Result[];
  status: string;
};
interface Result {
  address_components: Addresscomponent[];
  formatted_address: string;
  geometry: Geometry;
  place_id: string;
  types: string[];
  plus_code?: Pluscode;
}
interface Geometry {
  location: Location;
  location_type: string;
  viewport: Viewport;
  bounds?: Viewport;
}
interface Viewport {
  northeast: Location;
  southwest: Location;
}
interface Location {
  lat: number;
  lng: number;
}
interface Addresscomponent {
  long_name: string;
  short_name: string;
  types: string[];
}
interface Pluscode {
  compound_code: string;
  global_code: string;
}
